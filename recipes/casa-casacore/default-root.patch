--- CMakeLists.txt.orig	2015-05-13 20:23:33.020772229 +0000
+++ CMakeLists.txt	2015-05-13 20:27:00.367197771 +0000
@@ -314,6 +314,10 @@
     add_definitions(-DUSE_STACKTRACE)
 endif(USE_STACKTRACE)
 
+# conda-build hack
+add_definitions(-DCONDA_CASA_ROOT="${CONDA_CASA_ROOT}")
+# end conda-build hack
+
 # Add the modules to be built.
 add_subdirectory (build-tools)
 foreach (module ${_modules})
--- casa/System/Aipsrc.cc.orig	2015-05-13 20:23:25.424756643 +0000
+++ casa/System/Aipsrc.cc	2015-05-13 20:29:57.773561857 +0000
@@ -215,9 +215,9 @@
     } else { 
       aipsPath = extAipsPath;
     }
-    // Set the path to home if not defined in any way.
+    // conda-build hack: default is known; hack to fix zero-pad issues on OSX
     if (aipsPath.empty()) {
-      setAipsPath(uhome);
+      setAipsPath(String(String(CONDA_CASA_ROOT).chars()));
       aipsPath = extAipsPath;
     }
     Int n = aipsPath.freq(' ') + aipsPath.freq('	') + 4;
--- casa/System/Aipsrc.cc.orig	2016-02-02 22:06:41.314849499 +0000
+++ casa/System/Aipsrc.cc	2016-02-02 22:08:02.513055617 +0000
@@ -422,7 +422,7 @@
     if (find(x, String("user.aipsdir"), String("/aips++"))) {
       home = x;
     } else {
-      home = uhome + x;
+      home = String(String(CONDA_CASA_ROOT).chars());
     }
   }
 }
--- measures/Measures/MeasIERS.cc.orig	2015-04-10 10:36:56.000000000 +0000
+++ measures/Measures/MeasIERS.cc	2016-12-22 21:26:04.081459190 +0000
@@ -436,7 +436,7 @@
 		  found = True;
 		  break;
 		}
-		Path cdatapath(String(CASADATA));
+		Path cdatapath(String(String(CASADATA).chars()));
 		ldir = cdatapath.absoluteName() + path[i];
 		searched.resize(searched.nelements() + 1, True);
 		searched[searched.nelements() - 1] = ldir;
--- measures/Measures/MeasTable.cc.orig	2015-04-10 10:36:56.000000000 +0000
+++ measures/Measures/MeasTable.cc	2016-12-22 21:26:48.507138096 +0000
@@ -2997,12 +2997,12 @@
 	isValid = Table::isReadable(absPathName);
       }
       if(!isValid){
-	Path lPath(String(CASADATA) + "/" + antRespPath);
+	Path lPath(String(String(CASADATA).chars()) + "/" + antRespPath);
 	absPathName = lPath.absoluteName();
 	isValid = Table::isReadable(absPathName);
       }
       if(!isValid){
-	Path lPath(String(CASADATA)+ "/share/casacore/data/" + antRespPath);
+	Path lPath(String(String(CASADATA).chars())+ "/share/casacore/data/" + antRespPath);
 	absPathName = lPath.absoluteName();
 	isValid = Table::isReadable(absPathName);
       }
